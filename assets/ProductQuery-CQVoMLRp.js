var L=(P,w,r)=>new Promise((p,f)=>{var h=u=>{try{c(r.next(u))}catch(v){f(v)}},k=u=>{try{c(r.throw(u))}catch(v){f(v)}},c=u=>u.done?p(u.value):Promise.resolve(u.value).then(h,k);c((r=r.apply(P,w)).next())});import{_ as Y,i as Z,r as g,k as z,o as ee,c as _,d as s,b as o,n as y,w as a,e as m,l as te,a as oe,t as d,m as F,f as C,F as A,p as B,g as i,v as I,s as N}from"./index-iyMuq2FD.js";function se(P,w=300){let r=null;return function(...p){r&&clearTimeout(r),r=setTimeout(()=>{P.apply(this,p),r=null},w)}}const le={class:"product-query-page page-container"},ae={class:"search-wrapper"},ne={class:"stats-bar"},ie={class:"stat-item"},re={class:"stat-value"},ce={class:"stat-item"},ue={class:"stat-value"},de={class:"stat-item"},ve={class:"stat-value"},_e={key:0,class:"filter-tags"},me={class:"content-wrapper"},ke={key:0,class:"empty-state"},pe={class:"product-image"},fe=["src","alt"],ge={key:1,class:"image-placeholder"},ye={key:2,class:"stock-badge out-of-stock-badge"},he={key:3,class:"stock-badge low-stock-badge"},Se={class:"product-info"},be={class:"product-header"},Ce={class:"product-name"},we={class:"product-price"},Ve={class:"product-meta"},ze={class:"product-spec"},Pe={class:"product-footer"},xe={class:"stock-info"},Fe={class:"price-info"},$e={class:"price-value"},Le={key:0,class:"product-code"},Ee={class:"filter-popup"},Oe={class:"popup-header"},Ue={class:"filter-content"},Ae={__name:"ProductQuery",setup(P){const w=oe(),r=Z(),p=g(""),f=g(!1),h=g(!1),k=g(""),c=g(""),u=g(""),v=g(""),T=z(()=>{const l=new Set;return r.getAllProducts.forEach(e=>{e.category&&l.add(e.category)}),Array.from(l).sort()}),V=z(()=>{let l=r.getAllProducts;if(p.value){const e=p.value.toLowerCase();l=l.filter(n=>n.name.toLowerCase().includes(e)||n.code&&n.code.toLowerCase().includes(e)||n.size&&n.size.toString().includes(e)||n.category&&n.category.toLowerCase().includes(e)||n.color&&n.color.toLowerCase().includes(e))}return k.value&&(l=l.filter(e=>e.category===k.value)),c.value==="inStock"?l=l.filter(e=>e.stock>0):c.value==="outOfStock"?l=l.filter(e=>e.stock===0):c.value==="lowStock"&&(l=l.filter(e=>e.stock>0&&e.stock<=e.minStock)),l.sort((e,n)=>e.stock===0&&n.stock>0?1:e.stock>0&&n.stock===0?-1:0)}),R=z(()=>V.value.filter(l=>l.stock>0).length),q=z(()=>V.value.filter(l=>l.stock===0).length),Q=z(()=>k.value||c.value),D=se(()=>{},300),$=()=>{D()},K=()=>L(this,null,function*(){f.value=!0;try{yield r.loadProducts(),N("åˆ·æ–°æˆåŠŸ")}catch(l){N("åˆ·æ–°å¤±è´¥")}finally{f.value=!1}}),M=()=>{k.value=u.value,c.value=v.value,h.value=!1},j=()=>{k.value="",c.value="",u.value="",v.value=""},G=l=>{l.target.style.display="none";const e=l.target.nextElementSibling;e&&(e.style.display="flex")};return ee(()=>L(this,null,function*(){yield r.loadProducts()})),(l,e)=>{const n=m("van-icon"),H=m("van-nav-bar"),J=m("van-search"),x=m("van-tag"),E=m("van-button"),W=m("van-pull-refresh"),S=m("van-radio"),b=m("van-cell"),O=m("van-radio-group"),U=m("van-cell-group"),X=m("van-popup");return i(),_("div",le,[s(H,{title:"å•†å“æŸ¥è¯¢","left-arrow":"",onClickLeft:e[1]||(e[1]=t=>te(w).back())},{right:a(()=>[s(n,{name:"filter-o",size:"20",onClick:e[0]||(e[0]=t=>h.value=!0)})]),_:1}),o("div",ae,[s(J,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t),placeholder:"æœç´¢è´§å·ã€é¢œè‰²ã€å°ºç æˆ–åˆ†ç±»",onSearch:$,onClear:$,onInput:$},null,8,["modelValue"])]),o("div",ne,[o("div",ie,[o("div",re,d(V.value.length),1),e[14]||(e[14]=o("div",{class:"stat-label"},"æŸ¥è¯¢ç»“æžœ",-1))]),o("div",ce,[o("div",ue,d(R.value),1),e[15]||(e[15]=o("div",{class:"stat-label"},"æœ‰åº“å­˜",-1))]),o("div",de,[o("div",ve,d(q.value),1),e[16]||(e[16]=o("div",{class:"stat-label"},"ç¼ºè´§",-1))])]),Q.value?(i(),_("div",_e,[k.value?(i(),F(x,{key:0,closeable:"",type:"primary",onClose:e[3]||(e[3]=t=>k.value="")},{default:a(()=>[C(d(k.value),1)]),_:1})):y("",!0),c.value?(i(),F(x,{key:1,closeable:"",type:"warning",onClose:e[4]||(e[4]=t=>c.value="")},{default:a(()=>[C(d(c.value==="inStock"?"æœ‰åº“å­˜":c.value==="outOfStock"?"ç¼ºè´§":"åº“å­˜ç´§å¼ "),1)]),_:1})):y("",!0),s(E,{size:"small",type:"danger",plain:"",onClick:j},{default:a(()=>[...e[17]||(e[17]=[C(" æ¸…é™¤å…¨éƒ¨ ",-1)])]),_:1})])):y("",!0),o("div",me,[s(W,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=t=>f.value=t),onRefresh:K},{default:a(()=>[V.value.length===0?(i(),_("div",ke,[...e[18]||(e[18]=[o("div",{class:"empty-icon"},"ðŸ”",-1),o("div",{class:"empty-text"},"æœªæ‰¾åˆ°åŒ¹é…çš„å•†å“",-1),o("div",{class:"empty-tip"},"å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶",-1)])])):y("",!0),(i(!0),_(A,null,B(V.value,t=>(i(),_("div",{key:t.id,class:I(["product-card",{"out-of-stock":t.stock===0}])},[o("div",pe,[t.image?(i(),_("img",{key:0,src:t.image,alt:t.name,onError:G},null,40,fe)):(i(),_("div",ge,[s(n,{name:"photo-o",size:"32"})])),t.stock===0?(i(),_("div",ye," ç¼ºè´§ ")):t.stock<=t.minStock?(i(),_("div",he," åº“å­˜ç´§å¼  ")):y("",!0)]),o("div",Se,[o("div",be,[o("h3",Ce,d(t.name),1),o("div",we,"Â¥"+d(t.salePrice.toFixed(2)),1)]),o("div",Ve,[s(x,{type:"primary",size:"small"},{default:a(()=>[C("è´§å·: "+d(t.code),1)]),_:2},1024),t.category?(i(),F(x,{key:0,plain:"",size:"small"},{default:a(()=>[C(d(t.category),1)]),_:2},1024)):y("",!0),o("span",ze,d(t.size)+"ç  | "+d(t.color),1)]),o("div",Pe,[o("div",xe,[e[19]||(e[19]=o("span",{class:"stock-label"},"åº“å­˜:",-1)),o("span",{class:I(["stock-value",{"low-stock":t.stock>0&&t.stock<=t.minStock,"out-of-stock":t.stock===0}])},d(t.stock)+" ä»¶ ",3)]),o("div",Fe,[e[20]||(e[20]=o("span",{class:"price-label"},"å”®ä»·:",-1)),o("span",$e,"Â¥"+d(t.salePrice.toFixed(2)),1)])]),t.code?(i(),_("div",Le,[s(n,{name:"qr",size:"12"}),o("span",null,"ç¼–ç : "+d(t.code),1)])):y("",!0)])],2))),128))]),_:1},8,["modelValue"])]),s(X,{show:h.value,"onUpdate:show":e[13]||(e[13]=t=>h.value=t),position:"bottom",style:{height:"50%"},round:""},{default:a(()=>[o("div",Ee,[o("div",Oe,[e[22]||(e[22]=o("span",{class:"popup-title"},"ç­›é€‰æ¡ä»¶",-1)),s(E,{type:"primary",size:"small",onClick:M},{default:a(()=>[...e[21]||(e[21]=[C(" åº”ç”¨ ",-1)])]),_:1})]),o("div",Ue,[s(U,{title:"å•†å“åˆ†ç±»",inset:""},{default:a(()=>[s(O,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value=t)},{default:a(()=>[s(b,{title:"å…¨éƒ¨",clickable:"",onClick:e[6]||(e[6]=t=>u.value="")},{"right-icon":a(()=>[s(S,{name:""})]),_:1}),(i(!0),_(A,null,B(T.value,t=>(i(),F(b,{key:t,title:t,clickable:"",onClick:Be=>u.value=t},{"right-icon":a(()=>[s(S,{name:t},null,8,["name"])]),_:2},1032,["title","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(U,{title:"åº“å­˜çŠ¶æ€",inset:""},{default:a(()=>[s(O,{modelValue:v.value,"onUpdate:modelValue":e[12]||(e[12]=t=>v.value=t)},{default:a(()=>[s(b,{title:"å…¨éƒ¨",clickable:"",onClick:e[8]||(e[8]=t=>v.value="")},{"right-icon":a(()=>[s(S,{name:""})]),_:1}),s(b,{title:"æœ‰åº“å­˜",clickable:"",onClick:e[9]||(e[9]=t=>v.value="inStock")},{"right-icon":a(()=>[s(S,{name:"inStock"})]),_:1}),s(b,{title:"ç¼ºè´§",clickable:"",onClick:e[10]||(e[10]=t=>v.value="outOfStock")},{"right-icon":a(()=>[s(S,{name:"outOfStock"})]),_:1}),s(b,{title:"åº“å­˜ç´§å¼ ",clickable:"",onClick:e[11]||(e[11]=t=>v.value="lowStock")},{"right-icon":a(()=>[s(S,{name:"lowStock"})]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1},8,["show"])])}}},Te=Y(Ae,[["__scopeId","data-v-acb4aad3"]]);export{Te as default};
