var F=(z,u,v)=>new Promise((_,C)=>{var b=l=>{try{k(v.next(l))}catch(P){C(P)}},f=l=>{try{k(v.throw(l))}catch(P){C(P)}},k=l=>l.done?_(l.value):Promise.resolve(l.value).then(b,f);k((v=v.apply(z,u)).next())});import{_ as Q,i as W,u as X,r as V,k as h,P as S,c as y,d as i,b as o,w as n,m,n as r,l as p,a as Y,e as c,F as I,p as O,f as d,g as a,t as g,v as Z,x as B,s as $,q as tt}from"./index.CtZro4Eu.js";import{s as et}from"./search.CbM0cuqP.js";const st={class:"products-page page-container"},ot={class:"search-wrapper"},at={class:"filter-tabs"},nt={class:"content-wrapper"},lt={key:0,class:"empty-state"},it=["onClick"],rt={class:"product-image"},ct=["src","alt"],dt={key:0,class:"stock-warning-badge"},ut={class:"product-info"},vt={class:"product-header"},mt={class:"product-name"},pt={key:0,class:"product-price"},_t={class:"product-meta"},ft={class:"product-spec"},kt={class:"product-footer"},yt={class:"stock-info"},gt={class:"product-actions"},bt={__name:"Products",setup(z){const u=Y(),v=W(),_=X(),C=V(1),b=V(""),f=V("all"),k=h(()=>_.hasPermission(S.PRODUCT_ADD)),l=h(()=>_.hasPermission(S.PRODUCT_EDIT)),P=h(()=>_.hasPermission(S.PRODUCT_DELETE)),N=h(()=>{const s=new Set;return v.getAllProducts.forEach(t=>{t.category&&t.category!=="ÂÖ∂‰ªñ"&&s.add(t.category)}),Array.from(s).sort()}),x=h(()=>{let s=v.getAllProducts;return b.value&&(s=et(s,b.value)),f.value==="low"?s=s.filter(t=>t.stock<=t.minStock):f.value!=="all"&&(s=s.filter(t=>t.category===f.value)),s}),E=()=>{},L=()=>{},M=s=>{l.value&&u.push(`/product/edit/${s.id}`)},q=s=>{u.push(`/product/edit/${s.id}`)},K=s=>F(this,null,function*(){if(!P.value){$("ÊÇ®Ê≤°ÊúâÂà†Èô§ÂïÜÂìÅÁöÑÊùÉÈôê");return}try{yield tt({title:"Á°ÆËÆ§Âà†Èô§",message:`Á°ÆÂÆöË¶ÅÂà†Èô§ÂïÜÂìÅ"${s.name}"ÂêóÔºü`}),(yield v.deleteProduct(s.id))!==!1?$({type:"success",message:"Âà†Èô§ÊàêÂäü"}):$({type:"fail",message:"Âà†Èô§Â§±Ë¥•"})}catch(t){}});return(s,t)=>{const A=c("van-icon"),j=c("van-nav-bar"),G=c("van-search"),T=c("van-tab"),H=c("van-tabs"),D=c("van-button"),R=c("van-tag"),w=c("van-tabbar-item"),J=c("van-tabbar");return a(),y("div",st,[i(j,{title:"ÂïÜÂìÅÁÆ°ÁêÜ","left-arrow":"",onClickLeft:t[2]||(t[2]=e=>p(u).back())},{right:n(()=>[k.value?(a(),m(A,{key:0,name:"apps-o",size:"22",onClick:t[0]||(t[0]=e=>p(u).push("/product/batch-add"))})):r("",!0),k.value?(a(),m(A,{key:1,name:"plus",size:"22",onClick:t[1]||(t[1]=e=>p(u).push("/product/add"))})):r("",!0)]),_:1}),o("div",ot,[i(G,{modelValue:b.value,"onUpdate:modelValue":t[3]||(t[3]=e=>b.value=e),placeholder:"ÊêúÁ¥¢Ë¥ßÂè∑„ÄÅÈ¢úËâ≤„ÄÅÂ∞∫Á†ÅÊàñÂàÜÁ±ª",onSearch:E,onClear:E},null,8,["modelValue"])]),o("div",at,[i(H,{active:f.value,"onUpdate:active":t[4]||(t[4]=e=>f.value=e),onChange:L},{default:n(()=>[i(T,{title:"ÂÖ®ÈÉ®",name:"all"}),i(T,{title:"‰ΩéÂ∫ìÂ≠ò",name:"low"}),(a(!0),y(I,null,O(N.value,e=>(a(),m(T,{key:e,title:e,name:e},null,8,["title","name"]))),128))]),_:1},8,["active"])]),o("div",nt,[x.value.length===0?(a(),y("div",lt,[t[8]||(t[8]=o("div",{class:"empty-state-icon"},"üì¶",-1)),t[9]||(t[9]=o("div",{class:"empty-state-text"},"ÊöÇÊó†ÂïÜÂìÅÊï∞ÊçÆ",-1)),k.value?(a(),m(D,{key:0,type:"primary",size:"small",style:{"margin-top":"16px"},onClick:t[5]||(t[5]=e=>p(u).push("/product/add"))},{default:n(()=>[...t[7]||(t[7]=[d(" Ê∑ªÂä†ÂïÜÂìÅ ",-1)])]),_:1})):r("",!0)])):r("",!0),(a(!0),y(I,null,O(x.value,e=>(a(),y("div",{key:e.id,class:"product-card",onClick:U=>M(e)},[o("div",rt,[o("img",{src:e.image,alt:e.name},null,8,ct),e.stock<=e.minStock?(a(),y("div",dt," Â∫ìÂ≠òÈ¢ÑË≠¶ ")):r("",!0)]),o("div",ut,[o("div",vt,[o("h3",mt,g(e.name),1),p(_).hasPermission(p(S).STATS_PROFIT)?(a(),y("div",pt," ¬•"+g(e.salePrice),1)):r("",!0)]),o("div",_t,[i(R,{type:"primary",size:"medium"},{default:n(()=>[d("Ë¥ßÂè∑: "+g(e.code),1)]),_:2},1024),e.category?(a(),m(R,{key:0,plain:"",size:"medium"},{default:n(()=>[d(g(e.category),1)]),_:2},1024)):r("",!0),o("span",ft,g(e.size)+"Á†Å | "+g(e.color),1)]),o("div",kt,[o("div",yt,[t[10]||(t[10]=o("span",{class:"stock-label"},"Â∫ìÂ≠ò:",-1)),o("span",{class:Z(["stock-value",{"low-stock":e.stock<=e.minStock}])},g(e.stock),3)]),o("div",gt,[l.value?(a(),m(D,{key:0,size:"small",type:"primary",plain:"",onClick:B(U=>q(e),["stop"])},{default:n(()=>[...t[11]||(t[11]=[d(" ÁºñËæë ",-1)])]),_:1},8,["onClick"])):r("",!0),P.value?(a(),m(D,{key:1,size:"small",type:"danger",plain:"",onClick:B(U=>K(e),["stop"])},{default:n(()=>[...t[12]||(t[12]=[d(" Âà†Èô§ ",-1)])]),_:1},8,["onClick"])):r("",!0)])])])],8,it))),128))]),i(J,{modelValue:C.value,"onUpdate:modelValue":t[6]||(t[6]=e=>C.value=e),"active-color":"#5B8FF9","inactive-color":"#7d7e80"},{default:n(()=>[i(w,{icon:"home-o",to:"/home"},{default:n(()=>[...t[13]||(t[13]=[d("È¶ñÈ°µ",-1)])]),_:1}),i(w,{icon:"bag-o",to:"/products"},{default:n(()=>[...t[14]||(t[14]=[d("ÂïÜÂìÅ",-1)])]),_:1}),i(w,{icon:"shopping-cart-o",to:"/sales"},{default:n(()=>[...t[15]||(t[15]=[d("ÈîÄÂîÆ",-1)])]),_:1}),p(_).hasPermission(p(S).STATS_PROFIT)?(a(),m(w,{key:0,icon:"bar-chart-o",to:"/statistics"},{default:n(()=>[...t[16]||(t[16]=[d(" ÁªüËÆ° ",-1)])]),_:1})):r("",!0)]),_:1},8,["modelValue"])])}}},St=Q(bt,[["__scopeId","data-v-c4738495"]]);export{St as default};
