var q=(N,P,f)=>new Promise((d,k)=>{var l=u=>{try{s(f.next(u))}catch(_){k(_)}},x=u=>{try{s(f.throw(u))}catch(_){k(_)}},s=u=>u.done?d(u.value):Promise.resolve(u.value).then(l,x);s((f=f.apply(N,P)).next())});import{_ as H,i as R,r as C,k as z,c as b,d as a,b as o,w as c,e as v,l as j,a as G,n as J,F as h,p as B,t as p,f as F,g as y,v as K,s as g,z as M,A as I}from"./index.uKfIfdg1.js";const O={class:"batch-add-page page-container"},Q={class:"content-wrapper"},W={class:"card"},X={class:"card"},Y={class:"size-grid"},Z=["onClick"],ee={class:"size-tip"},le={key:0,class:"card"},oe={class:"section-title"},te={class:"preview-list"},se={class:"preview-name"},ae={class:"preview-meta"},ne={class:"actions"},re={class:"popup-header"},ue={__name:"ProductBatchAdd",setup(N){const P=G(),f=R(),d=C(!1),k=C(!1),l=C({code:"",color:"",category:"",costPrice:"",salePrice:"",stock:"10"}),x=["34","35","36","37","38","39","40","41"],s=C([]),u=["é«˜è·Ÿé‹","å¹³åº•é‹","è¿åŠ¨é‹","ä¼‘é—²é‹","å‡‰é‹","æ‹–é‹","é´å­","å•é‹","å¸†å¸ƒé‹","æ¿é‹","åšåº•é‹","å…¶ä»–"],_=n=>{const e=s.value.indexOf(n);e>-1?s.value.splice(e,1):s.value.push(n),s.value.sort((m,i)=>parseInt(m)-parseInt(i))},T=({selectedOptions:n})=>{l.value.category=n[0].text||n[0],d.value=!1},V=z(()=>!l.value.code||!l.value.color||s.value.length===0?[]:s.value.map(n=>({name:`${l.value.code}-${l.value.color}-${n}ç `,code:l.value.code,color:l.value.color,size:n,category:l.value.category,costPrice:parseFloat(l.value.costPrice)||0,salePrice:parseFloat(l.value.salePrice)||0,stock:parseInt(l.value.stock)||0,minStock:5}))),S=z(()=>l.value.code&&l.value.color&&l.value.category&&l.value.costPrice&&l.value.salePrice&&l.value.stock&&s.value.length>0),A=()=>q(this,null,function*(){if(!S.value){g("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯å¹¶é€‰æ‹©å°ºç ");return}const n=parseFloat(l.value.costPrice),e=parseFloat(l.value.salePrice),m=parseInt(l.value.stock);if(isNaN(n)||n<=0){g("è¯·è¾“å…¥æœ‰æ•ˆçš„æˆæœ¬ä»·");return}if(isNaN(e)||e<=0){g("è¯·è¾“å…¥æœ‰æ•ˆçš„é”€å”®ä»·");return}if(isNaN(m)||m<0){g("è¯·è¾“å…¥æœ‰æ•ˆçš„åº“å­˜æ•°é‡");return}M({message:"æ­£åœ¨æ·»åŠ ...",forbidClick:!0,duration:0});try{let i=0,r=0;for(const w of V.value)try{yield f.addProduct(w),i++}catch($){console.error("æ·»åŠ å•†å“å¤±è´¥:",w.name,$),r++}I(),r===0?(g({type:"success",message:`æˆåŠŸæ·»åŠ  ${i} ä¸ªå•†å“ï¼`}),setTimeout(()=>{P.back()},1e3)):g({type:"warning",message:`æˆåŠŸ ${i} ä¸ªï¼Œå¤±è´¥ ${r} ä¸ª`})}catch(i){I(),g("æ‰¹é‡æ·»åŠ å¤±è´¥"),console.error("æ‰¹é‡æ·»åŠ å¼‚å¸¸:",i)}});return(n,e)=>{const m=v("van-icon"),i=v("van-nav-bar"),r=v("van-field"),w=v("van-form"),$=v("van-button"),L=v("van-picker"),D=v("van-popup"),E=v("van-dialog");return y(),b("div",O,[a(i,{title:"æ‰¹é‡æ·»åŠ å•†å“","left-arrow":"",onClickLeft:e[1]||(e[1]=t=>j(P).back())},{right:c(()=>[a(m,{name:"question-o",size:"22",onClick:e[0]||(e[0]=t=>k.value=!0)})]),_:1}),o("div",Q,[o("div",W,[e[16]||(e[16]=o("div",{class:"section-title"},"ğŸ“ åŸºæœ¬ä¿¡æ¯",-1)),a(w,null,{default:c(()=>[a(r,{modelValue:l.value.code,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.code=t),name:"code",label:"è´§å·",placeholder:"ä¾‹å¦‚ï¼š206731-2",rules:[{required:!0,message:"è¯·è¾“å…¥è´§å·"}]},null,8,["modelValue"]),a(r,{modelValue:l.value.color,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.color=t),name:"color",label:"é¢œè‰²",placeholder:"è¯·è¾“å…¥é¢œè‰²",rules:[{required:!0,message:"è¯·è¾“å…¥é¢œè‰²"}]},null,8,["modelValue"]),a(r,{modelValue:l.value.category,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.category=t),name:"category",label:"åˆ†ç±»",placeholder:"è¯·é€‰æ‹©åˆ†ç±»","is-link":"",readonly:"",onClick:e[5]||(e[5]=t=>d.value=!0),rules:[{required:!0,message:"è¯·é€‰æ‹©åˆ†ç±»"}]},null,8,["modelValue"]),a(r,{modelValue:l.value.costPrice,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.costPrice=t),name:"costPrice",type:"number",label:"æˆæœ¬ä»·",placeholder:"è¯·è¾“å…¥æˆæœ¬ä»·",rules:[{required:!0,message:"è¯·è¾“å…¥æˆæœ¬ä»·"}]},{button:c(()=>[...e[13]||(e[13]=[o("span",null,"å…ƒ",-1)])]),_:1},8,["modelValue"]),a(r,{modelValue:l.value.salePrice,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.salePrice=t),name:"salePrice",type:"number",label:"é”€å”®ä»·",placeholder:"è¯·è¾“å…¥é”€å”®ä»·",rules:[{required:!0,message:"è¯·è¾“å…¥é”€å”®ä»·"}]},{button:c(()=>[...e[14]||(e[14]=[o("span",null,"å…ƒ",-1)])]),_:1},8,["modelValue"]),a(r,{modelValue:l.value.stock,"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.stock=t),name:"stock",type:"number",label:"æ¯ä¸ªå°ºç åº“å­˜",placeholder:"è¯·è¾“å…¥åº“å­˜æ•°é‡",rules:[{required:!0,message:"è¯·è¾“å…¥åº“å­˜æ•°é‡"}]},{button:c(()=>[...e[15]||(e[15]=[o("span",null,"ä»¶",-1)])]),_:1},8,["modelValue"])]),_:1})]),o("div",X,[e[17]||(e[17]=o("div",{class:"section-title"},"ğŸ‘Ÿ é€‰æ‹©å°ºç ",-1)),o("div",Y,[(y(),b(h,null,B(x,t=>o("div",{key:t,class:K(["size-item",{active:s.value.includes(t)}]),onClick:U=>_(t)},p(t)+"ç  ",11,Z)),64))]),o("div",ee," å·²é€‰æ‹© "+p(s.value.length)+" ä¸ªå°ºç  ",1)]),V.value.length>0?(y(),b("div",le,[o("div",oe,"ğŸ‘€ é¢„è§ˆï¼ˆå°†æ·»åŠ  "+p(V.value.length)+" ä¸ªå•†å“ï¼‰",1),o("div",te,[(y(!0),b(h,null,B(V.value,(t,U)=>(y(),b("div",{key:U,class:"preview-item"},[o("div",se,p(t.name),1),o("div",ae,[o("span",null,p(t.size)+"ç ",1),o("span",null,"åº“å­˜: "+p(t.stock)+"ä»¶",1),o("span",null,"Â¥"+p(t.salePrice),1)])]))),128))])])):J("",!0),o("div",ne,[a($,{type:"primary",block:"",round:"",size:"large",disabled:!S.value,onClick:A},{default:c(()=>[F(" æ‰¹é‡æ·»åŠ  "+p(s.value.length)+" ä¸ªå•†å“ ",1)]),_:1},8,["disabled"])])]),a(D,{show:d.value,"onUpdate:show":e[11]||(e[11]=t=>d.value=t),position:"bottom",round:""},{default:c(()=>[o("div",re,[e[18]||(e[18]=o("span",null,null,-1)),e[19]||(e[19]=o("span",{class:"popup-title"},"é€‰æ‹©åˆ†ç±»",-1)),a(m,{name:"cross",class:"popup-close",onClick:e[9]||(e[9]=t=>d.value=!1)})]),a(L,{columns:u,onConfirm:T,onCancel:e[10]||(e[10]=t=>d.value=!1)})]),_:1},8,["show"]),a(E,{show:k.value,"onUpdate:show":e[12]||(e[12]=t=>k.value=t),title:"ä½¿ç”¨è¯´æ˜","confirm-button-text":"çŸ¥é“äº†"},{default:c(()=>[...e[20]||(e[20]=[o("div",{style:{padding:"16px","text-align":"left"}},[o("p",null,[o("strong",null,"æ‰¹é‡æ·»åŠ åŠŸèƒ½è¯´æ˜ï¼š")]),o("ol",{style:{"padding-left":"20px",margin:"8px 0"}},[o("li",null,"å¡«å†™å•†å“åŸºæœ¬ä¿¡æ¯ï¼ˆè´§å·ã€é¢œè‰²ã€ä»·æ ¼ç­‰ï¼‰"),o("li",null,"é€‰æ‹©éœ€è¦æ·»åŠ çš„å°ºç ï¼ˆå¯å¤šé€‰ï¼‰"),o("li",null,"ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªå°ºç åˆ›å»ºä¸€ä¸ªå•†å“"),o("li",null,"å•†å“åç§°è‡ªåŠ¨ç”Ÿæˆï¼šè´§å·-é¢œè‰²-å°ºç ")]),o("p",{style:{"margin-top":"12px",color:"#ff976a"}},[o("strong",null,"æç¤ºï¼š"),F("æ‰¹é‡æ·»åŠ é€‚åˆåŒæ¬¾ä¸åŒå°ºç çš„å•†å“å¿«é€Ÿå½•å…¥ã€‚ ")])],-1)])]),_:1},8,["show"])])}}},ce=H(ue,[["__scopeId","data-v-3da630cf"]]);export{ce as default};
