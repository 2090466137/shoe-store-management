var U=(x,v,u)=>new Promise((m,C)=>{var g=l=>{try{b(u.next(l))}catch(P){C(P)}},_=l=>{try{b(u.throw(l))}catch(P){C(P)}},b=l=>l.done?m(l.value):Promise.resolve(l.value).then(g,_);b((u=u.apply(x,v)).next())});import{_ as Q,i as W,u as X,r as V,k as h,P as S,c as p,d as i,b as o,w as n,m as f,n as r,l as k,a as Y,e as c,F,p as I,f as d,g as a,t as y,v as Z,x as O,s as $,q as tt}from"./index-iyMuq2FD.js";import{s as et}from"./search-CbM0cuqP.js";const st={class:"products-page page-container"},ot={class:"search-wrapper"},at={class:"filter-tabs"},nt={class:"content-wrapper"},lt={key:0,class:"empty-state"},it=["onClick"],rt={class:"product-image"},ct=["src","alt"],dt={key:0,class:"stock-warning-badge"},ut={class:"product-info"},vt={class:"product-header"},mt={class:"product-name"},_t={key:0,class:"product-price"},pt={class:"product-meta"},ft={class:"product-spec"},kt={class:"product-footer"},yt={class:"stock-info"},gt={class:"product-actions"},bt={__name:"Products",setup(x){const v=Y(),u=W(),m=X(),C=V(1),g=V(""),_=V("all"),b=h(()=>m.hasPermission(S.PRODUCT_ADD)),l=h(()=>m.hasPermission(S.PRODUCT_EDIT)),P=h(()=>m.hasPermission(S.PRODUCT_DELETE)),B=h(()=>{const s=new Set;return u.getAllProducts.forEach(t=>{t.category&&t.category!=="ÂÖ∂‰ªñ"&&s.add(t.category)}),Array.from(s).sort()}),z=h(()=>{let s=u.getAllProducts;return g.value&&(s=et(s,g.value)),_.value==="low"?s=s.filter(t=>t.stock<=t.minStock):_.value!=="all"&&(s=s.filter(t=>t.category===_.value)),s}),E=()=>{},N=()=>{},L=s=>{l.value&&v.push(`/product/edit/${s.id}`)},M=s=>{v.push(`/product/edit/${s.id}`)},q=s=>U(this,null,function*(){if(!P.value){$("ÊÇ®Ê≤°ÊúâÂà†Èô§ÂïÜÂìÅÁöÑÊùÉÈôê");return}try{yield tt({title:"Á°ÆËÆ§Âà†Èô§",message:`Á°ÆÂÆöË¶ÅÂà†Èô§ÂïÜÂìÅ"${s.name}"ÂêóÔºü`}),(yield u.deleteProduct(s.id))!==!1?$({type:"success",message:"Âà†Èô§ÊàêÂäü"}):$({type:"fail",message:"Âà†Èô§Â§±Ë¥•"})}catch(t){}});return(s,t)=>{const K=c("van-icon"),j=c("van-nav-bar"),G=c("van-search"),T=c("van-tab"),H=c("van-tabs"),D=c("van-button"),A=c("van-tag"),w=c("van-tabbar-item"),J=c("van-tabbar");return a(),p("div",st,[i(j,{title:"ÂïÜÂìÅÁÆ°ÁêÜ","left-arrow":"",onClickLeft:t[1]||(t[1]=e=>k(v).back())},{right:n(()=>[b.value?(a(),f(K,{key:0,name:"plus",size:"20",onClick:t[0]||(t[0]=e=>k(v).push("/product/add"))})):r("",!0)]),_:1}),o("div",ot,[i(G,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=e=>g.value=e),placeholder:"ÊêúÁ¥¢Ë¥ßÂè∑„ÄÅÈ¢úËâ≤„ÄÅÂ∞∫Á†ÅÊàñÂàÜÁ±ª",onSearch:E,onClear:E},null,8,["modelValue"])]),o("div",at,[i(H,{active:_.value,"onUpdate:active":t[3]||(t[3]=e=>_.value=e),onChange:N},{default:n(()=>[i(T,{title:"ÂÖ®ÈÉ®",name:"all"}),i(T,{title:"‰ΩéÂ∫ìÂ≠ò",name:"low"}),(a(!0),p(F,null,I(B.value,e=>(a(),f(T,{key:e,title:e,name:e},null,8,["title","name"]))),128))]),_:1},8,["active"])]),o("div",nt,[z.value.length===0?(a(),p("div",lt,[t[7]||(t[7]=o("div",{class:"empty-state-icon"},"üì¶",-1)),t[8]||(t[8]=o("div",{class:"empty-state-text"},"ÊöÇÊó†ÂïÜÂìÅÊï∞ÊçÆ",-1)),b.value?(a(),f(D,{key:0,type:"primary",size:"small",style:{"margin-top":"16px"},onClick:t[4]||(t[4]=e=>k(v).push("/product/add"))},{default:n(()=>[...t[6]||(t[6]=[d(" Ê∑ªÂä†ÂïÜÂìÅ ",-1)])]),_:1})):r("",!0)])):r("",!0),(a(!0),p(F,null,I(z.value,e=>(a(),p("div",{key:e.id,class:"product-card",onClick:R=>L(e)},[o("div",rt,[o("img",{src:e.image,alt:e.name},null,8,ct),e.stock<=e.minStock?(a(),p("div",dt," Â∫ìÂ≠òÈ¢ÑË≠¶ ")):r("",!0)]),o("div",ut,[o("div",vt,[o("h3",mt,y(e.name),1),k(m).hasPermission(k(S).STATS_PROFIT)?(a(),p("div",_t," ¬•"+y(e.salePrice),1)):r("",!0)]),o("div",pt,[i(A,{type:"primary",size:"medium"},{default:n(()=>[d("Ë¥ßÂè∑: "+y(e.code),1)]),_:2},1024),e.category?(a(),f(A,{key:0,plain:"",size:"medium"},{default:n(()=>[d(y(e.category),1)]),_:2},1024)):r("",!0),o("span",ft,y(e.size)+"Á†Å | "+y(e.color),1)]),o("div",kt,[o("div",yt,[t[9]||(t[9]=o("span",{class:"stock-label"},"Â∫ìÂ≠ò:",-1)),o("span",{class:Z(["stock-value",{"low-stock":e.stock<=e.minStock}])},y(e.stock),3)]),o("div",gt,[l.value?(a(),f(D,{key:0,size:"small",type:"primary",plain:"",onClick:O(R=>M(e),["stop"])},{default:n(()=>[...t[10]||(t[10]=[d(" ÁºñËæë ",-1)])]),_:1},8,["onClick"])):r("",!0),P.value?(a(),f(D,{key:1,size:"small",type:"danger",plain:"",onClick:O(R=>q(e),["stop"])},{default:n(()=>[...t[11]||(t[11]=[d(" Âà†Èô§ ",-1)])]),_:1},8,["onClick"])):r("",!0)])])])],8,it))),128))]),i(J,{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=e=>C.value=e),"active-color":"#5B8FF9","inactive-color":"#7d7e80"},{default:n(()=>[i(w,{icon:"home-o",to:"/home"},{default:n(()=>[...t[12]||(t[12]=[d("È¶ñÈ°µ",-1)])]),_:1}),i(w,{icon:"bag-o",to:"/products"},{default:n(()=>[...t[13]||(t[13]=[d("ÂïÜÂìÅ",-1)])]),_:1}),i(w,{icon:"shopping-cart-o",to:"/sales"},{default:n(()=>[...t[14]||(t[14]=[d("ÈîÄÂîÆ",-1)])]),_:1}),k(m).hasPermission(k(S).STATS_PROFIT)?(a(),f(w,{key:0,icon:"bar-chart-o",to:"/statistics"},{default:n(()=>[...t[15]||(t[15]=[d(" ÁªüËÆ° ",-1)])]),_:1})):r("",!0)]),_:1},8,["modelValue"])])}}},St=Q(bt,[["__scopeId","data-v-f897f557"]]);export{St as default};
