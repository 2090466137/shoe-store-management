import{_ as N,j as w,i as C,u as A,r as q,c as a,d as l,b as o,w as u,e as m,l as e,a as R,n as c,P as y,t as i,f as p,F as S,p as V,m as O,g as n,x as B,q as D,s as E}from"./index-BxGv2y-T.js";const M={class:"sales-page page-container"},z={class:"content-wrapper"},j={key:0,class:"card"},L={class:"today-stats"},U={class:"today-stat-item"},H={class:"today-stat-value primary"},G={class:"today-stat-item"},J={class:"today-stat-value success"},K={class:"card"},Q={class:"card"},W={key:0,class:"empty-state"},X={class:"sale-header"},Y={class:"sale-product"},Z={key:0},tt={key:1},st={key:0,class:"sale-amount"},ot={class:"sale-info"},et={key:0},nt={key:0},at={key:1},dt={class:"sale-footer"},it={key:0,class:"sale-profit"},rt={class:"profit-value"},lt={class:"sale-actions"},ct={class:"sale-date"},ut={__name:"Sales",setup(pt){const g=R(),_=w(),k=C(),v=A(),h=q(2),T=d=>{const t=new Date(d);return`${t.getMonth()+1}æœˆ${t.getDate()}æ—¥ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`},P=d=>{let t="";d.products&&d.products.length>0?t=d.products.map(r=>`${r.productName} Ã—${r.quantity}`).join(`
`):t=`${d.productName}
æ•°é‡ï¼š${d.quantity}ä»¶`,D({title:"ç¡®è®¤åˆ é™¤",message:`ç¡®å®šè¦åˆ é™¤è¿™æ¡é”€å”®è®°å½•å—ï¼Ÿ

${t}
é‡‘é¢ï¼šÂ¥${d.totalAmount.toFixed(2)}

åˆ é™¤åŽå°†æ¢å¤åº“å­˜`}).then(()=>{d.products&&d.products.length>0?d.products.forEach(r=>{k.updateStock(r.productId,r.quantity,"add")}):k.updateStock(d.productId,d.quantity,"add"),_.deleteSale(d.id),E({type:"success",message:"åˆ é™¤æˆåŠŸï¼Œåº“å­˜å·²æ¢å¤"})}).catch(()=>{})};return(d,t)=>{const r=m("van-icon"),F=m("van-nav-bar"),$=m("van-button"),f=m("van-tabbar-item"),x=m("van-tabbar");return n(),a("div",M,[l(F,{title:"é”€å”®ç®¡ç†","left-arrow":"",onClickLeft:t[1]||(t[1]=s=>e(g).back())},{right:u(()=>[l(r,{name:"plus",size:"22",onClick:t[0]||(t[0]=s=>e(g).push("/sales/add"))})]),_:1}),o("div",z,[e(v).hasPermission(e(y).STATS_PROFIT)?(n(),a("div",j,[t[7]||(t[7]=o("div",{class:"section-title"},"ðŸ“Š ä»Šæ—¥æ•°æ®",-1)),o("div",L,[o("div",U,[o("div",H,"Â¥"+i(e(_).todaySales.toFixed(2)),1),t[4]||(t[4]=o("div",{class:"today-stat-label"},"é”€å”®é¢",-1))]),t[6]||(t[6]=o("div",{class:"today-stat-divider"},null,-1)),o("div",G,[o("div",J,"Â¥"+i(e(_).todayProfit.toFixed(2)),1),t[5]||(t[5]=o("div",{class:"today-stat-label"},"åˆ©æ¶¦",-1))])])])):c("",!0),o("div",K,[l($,{type:"warning",size:"large",block:"",icon:"exchange",onClick:t[2]||(t[2]=s=>e(g).push("/returns"))},{default:u(()=>[...t[8]||(t[8]=[p(" é€€æ¢è´§ç®¡ç† ",-1)])]),_:1})]),o("div",Q,[t[12]||(t[12]=o("div",{class:"section-title"},"ðŸ“‹ é”€å”®è®°å½•",-1)),e(_).sales.length===0?(n(),a("div",W,[l(r,{name:"shopping-cart-o",size:"64",color:"#4A90E2"}),t[9]||(t[9]=o("div",{class:"empty-state-text"},"æš‚æ— é”€å”®è®°å½•",-1)),t[10]||(t[10]=o("div",{class:"empty-state-tip"},"å‰å¾€æ”¶é“¶å°å¼€å§‹é”€å”®",-1))])):c("",!0),(n(!0),a(S,null,V(e(_).sales,s=>(n(),a("div",{key:s.id,class:"sale-item"},[o("div",X,[o("div",Y,[s.products&&s.products.length>0?(n(),a(S,{key:0},[s.products.length===1?(n(),a("span",Z,i(s.products[0].productName),1)):(n(),a("span",tt,i(s.products[0].productName)+" ç­‰"+i(s.products.length)+"ä»¶å•†å“",1))],64)):(n(),a(S,{key:1},[p(i(s.productName),1)],64))]),e(v).hasPermission(e(y).STATS_PROFIT)?(n(),a("div",st," Â¥"+i(s.totalAmount.toFixed(2)),1)):c("",!0)]),o("div",ot,[s.products&&s.products.length>0?(n(),a(S,{key:0},[o("span",null,"å…±"+i(s.products.reduce((b,I)=>b+I.quantity,0))+"ä»¶",1),s.salesperson?(n(),a("span",et,"é”€å”®å‘˜: "+i(s.salesperson),1)):c("",!0)],64)):(n(),a(S,{key:1},[o("span",null,"æ•°é‡: "+i(s.quantity)+"ä»¶",1),e(v).hasPermission(e(y).STATS_PROFIT)?(n(),a("span",nt," å•ä»·: Â¥"+i(s.salePrice),1)):c("",!0),s.salesperson?(n(),a("span",at,"é”€å”®å‘˜: "+i(s.salesperson),1)):c("",!0)],64))]),o("div",dt,[e(v).hasPermission(e(y).STATS_PROFIT)?(n(),a("div",it,[t[11]||(t[11]=o("span",{class:"profit-label"},"åˆ©æ¶¦:",-1)),o("span",rt,"Â¥"+i(s.profit.toFixed(2)),1)])):c("",!0),o("div",lt,[o("span",ct,i(T(s.time||s.date)),1),l(r,{name:"delete-o",class:"delete-icon",onClick:B(b=>P(s),["stop"])},null,8,["onClick"])])])]))),128))])]),l(x,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),"active-color":"#5B8FF9","inactive-color":"#7d7e80"},{default:u(()=>[l(f,{icon:"home-o",to:"/home"},{default:u(()=>[...t[13]||(t[13]=[p("é¦–é¡µ",-1)])]),_:1}),l(f,{icon:"bag-o",to:"/products"},{default:u(()=>[...t[14]||(t[14]=[p("å•†å“",-1)])]),_:1}),l(f,{icon:"shopping-cart-o",to:"/sales"},{default:u(()=>[...t[15]||(t[15]=[p("é”€å”®",-1)])]),_:1}),e(v).hasPermission(e(y).STATS_PROFIT)?(n(),O(f,{key:0,icon:"bar-chart-o",to:"/statistics"},{default:u(()=>[...t[16]||(t[16]=[p(" ç»Ÿè®¡ ",-1)])]),_:1})):c("",!0)]),_:1},8,["modelValue"])])}}},vt=N(ut,[["__scopeId","data-v-3c043e7c"]]);export{vt as default};
